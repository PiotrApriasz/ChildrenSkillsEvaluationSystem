@page "/Home"

@using MudBlazor
@using ChildrenEvaluationSystem.Web.SharedComponents.Widgets
@using ChildrenEvaluationSystem.Web.SharedComponents.Controls
@using ChildrenEvaluationSystem.Web.SharedComponents.Values
@using Microsoft.AspNetCore.Authorization
@using static Microsoft.AspNetCore.Components.Web.RenderMode
@using IAuthenticationService = ChildrenEvaluationSystem.Application.Interfaces.IAuthenticationService
@using Microsoft.AspNetCore.Components.Web

@inject NavigationManager Navigation
@inject IAuthenticationService AuthenticationService

@attribute [Authorize]


<div class="home-container">
    <div class="home-header">
        <MudText Typo="Typo.h3" Class="welcome-title">
            Witaj ponownie, @AuthenticationService.GetUsername()!
        </MudText>
        <MudText Typo="Typo.body1" Class="welcome-subtitle">
            Wybierz sekcję, którą chcesz zarządzać
        </MudText>
    </div>

    <div class="cards-grid grid-auto-cards">
        <FeatureCard Title="Grupy"
                     Description="Zarządzaj listą grup i przypisaniami."
                     Icon="@Icons.Material.Filled.Groups"
                     ChipText=@($"{_groupsCount} grup")
                     ChipIcon="@Icons.Material.Filled.ListAlt"
                     ChipColor="Color.Primary"
                     IconBackgroundClass="gradient--primary"
                     OnClick="NavigateToGroups" />

        <FeatureCard Title="Dzieci"
                     Description="Przeglądaj profile oraz historię obserwacji."
                     Icon="@Icons.Material.Filled.ChildCare"
                     ChipText="112 dzieci"
                     ChipIcon="@Icons.Material.Filled.Person"
                     ChipColor="Color.Secondary"
                     IconBackgroundClass="gradient--children"
                     OnClick="NavigateToChildren" />

        <FeatureCard Title="Diagnozy"
                     Description="Twórz i przeglądaj diagnozy rozwojowe."
                     Icon="@Icons.Material.Filled.Assignment"
                     ChipText="15 diagnoz"
                     ChipIcon="@Icons.Material.Filled.Analytics"
                     ChipColor="Color.Tertiary"
                     IconBackgroundClass="gradient--diagnoses"
                     OnClick="NavigateToDiagnoses" />
    </div>

    <div class="quick-actions top-divider">
        <MudText Typo="Typo.h6" Class="quick-actions-title">Szybkie akcje</MudText>
        <div class="quick-actions-buttons">
            <GlassButton ButtonStyle="ButtonStyles.Glass"
                         FullWidth="false"
                         Size="Size.Medium"
                         OnClick="NavigateToQuickActionChildAdd">
                <MudIcon Icon="@Icons.Material.Filled.PersonAdd" Class="mr-2" />
                Dodaj dziecko
            </GlassButton>

            <GlassButton ButtonStyle="ButtonStyles.Glass"
                         FullWidth="false"
                         Size="Size.Medium"
                         OnClick="NavigateToQuickActionNewDiagnosis">
                <MudIcon Icon="@Icons.Material.Filled.NoteAdd" Class="mr-2" />
                Nowa diagnoza
            </GlassButton>
        </div>
    </div>
</div>

<style>
    .home-container { max-width:1200px; margin:0 auto; padding:100px 20px 80px; }
    .home-header { text-align:center; margin-bottom:48px; }

    .welcome-title { color:var(--color-text-primary); font-weight:700; margin-bottom:12px; }
    .welcome-subtitle { color:var(--color-text-secondary); opacity:.8; }

    .cards-grid { margin-bottom:56px; }

    .quick-actions { text-align:center; padding-top:var(--space-24); }
    .quick-actions-title { color:var(--color-text-primary); margin-bottom:var(--space-24); font-weight:600; }

    .quick-actions-buttons { display:flex; gap:var(--space-16); justify-content:center; flex-wrap:wrap; }

    @@media (max-width:900px){
    .home-container { padding:72px 20px 56px; }
    }
    @@media (max-width:640px){
    .home-container { padding:48px 16px 48px; }
    .quick-actions-buttons { flex-direction:column; align-items:stretch; }
    :.welcome-title { font-size:1.9rem; }
    }
</style>